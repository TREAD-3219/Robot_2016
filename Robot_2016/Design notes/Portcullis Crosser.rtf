{\rtf1\ansi\ansicpg1252\cocoartf1404\cocoasubrtf340
{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
\margl1440\margr1440\vieww17680\viewh11200\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 Notes on a Portcullis crosser.\
\
Driving through a portcullis will need to be carefully coordinated with the raising mechanism to avoid putting undue stress on the portcullis or the multi-tool.\
Why?  Look at the geometry - the pickup point of the arm describes a partial circle, from below the horizontal axis of the arm by 30-45 degrees to above the axis by up to 90 degrees.  From the equation for a circle (x^2 + y^2 = r^2), we can derive x = sqrt(r^2 - y^2), where r is the radius of the arm from the pivot to the pickup point.  Note that the robot needs to reverse during the early part of the raise (just turn brakes off?) until the arm is level, followed by moving forward during the last part of the lift while the arm is above level.\
\
If we assume PortcullisCrosser is a PIDCommand, we can use an error function of Xa - Xr where Xr is the normalized x position of the robot and Xa is the normalized x position of the arm.  That is, the error is how much the robot position differs from the arm position.  We can then tune a PID function (mostly P) to minimize the error.\
\
Given encoders for both the drive and the multi-tool, we now need some formula that will relate them.  That is, an encoder count on the base is not directly related to an encoder count on the multi-tool arm.  However, if we calibrate the multi-tool arm to give us a fairly precise angle of arm to robot, we can easily convert this into the x and y positions of the portcullis lift point.  Note also that the robot will be at an angle to the ground during most of the lift, which can be read from the AHRS.  Taking that into account may also be necessary - at the start of the lift, the arm will need to be depressed below the flat-ground angle in order to get under the portcullis.\
\
\
\
\
}